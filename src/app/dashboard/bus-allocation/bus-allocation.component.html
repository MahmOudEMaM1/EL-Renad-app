<body>
    <mat-toolbar color="primary">
        <div class="logo-title-container">
            <img src="../assets/image2.png" alt="El-Renad Logo" class="navbar-logo">
            <span>{{ 'toolbar.title' | translate }}</span>
        </div>
        <span class="spacer"></span>
        <div class="toolbar-actions">
            <div class="toolbarTranslation">
                <app-language-toggle></app-language-toggle>
            </div>
            <button mat-button (click)="goBack()">{{ 'bus_allocation.back' | translate }}</button>
            <button mat-button (click)="logout()">{{ 'toolbar.logout' | translate }}</button>
        </div>
    </mat-toolbar>

    <div class="container">
        <h2>{{ 'bus_allocation.title' | translate }}</h2>
        <div class="filter-section">
            <select [(ngModel)]="filterColumn" (ngModelChange)="applyFilter()" class="filter-select">
          <option value="">{{ 'select_column' | translate }}</option>
          <option value="tripType">{{ 'bus_allocation.trip_type' | translate }}</option>
          <option value="tripPlace">{{ 'bus_allocation.trip_place' | translate }}</option>
          <option value="tripTimeRange">{{ 'bus_allocation.trip_time' | translate }}</option>
          <option value="totalStudents">{{ 'bus_allocation.total_students' | translate }}</option>
          <option value="allocationDate">{{ 'bus_allocation.allocationDate' | translate }}</option>
          <option value="buses">{{ 'bus_allocation.buses' | translate }}</option>
        </select>
            <input [(ngModel)]="filterValue" (ngModelChange)="applyFilter()" placeholder="{{ 'filter_placeholder' | translate }}" class="filter-input">
        </div>
        <div *ngIf="loading" class="loading">
            <mat-spinner diameter="40"></mat-spinner>
            <span>{{ 'bus_allocation.loading' | translate }}</span>
        </div>
        <div *ngIf="error" class="error">
            {{ error | translate }}
        </div>
        <table mat-table [dataSource]="dataSource" *ngIf="!loading && !error">
            <ng-container matColumnDef="tripType">
                <th mat-header-cell *matHeaderCellDef> {{ 'bus_allocation.trip_type' | translate }} </th>
                <td mat-cell *matCellDef="let alloc"> {{ alloc.tripType }} </td>
            </ng-container>
            <ng-container matColumnDef="tripPlace">
                <th mat-header-cell *matHeaderCellDef> {{ 'bus_allocation.trip_place' | translate }} </th>
                <td mat-cell *matCellDef="let alloc"> {{ alloc.tripPlaceId }} </td>
            </ng-container>
            <ng-container matColumnDef="tripTimeRange">
                <th mat-header-cell *matHeaderCellDef> {{ 'bus_allocation.trip_time' | translate }} </th>
                <td mat-cell *matCellDef="let alloc"> {{ alloc.tripTimeRange }} </td>
            </ng-container>
            <ng-container matColumnDef="totalStudents">
                <th mat-header-cell *matHeaderCellDef> {{ 'bus_allocation.total_students' | translate }} </th>
                <td mat-cell *matCellDef="let alloc"> {{ alloc.totalStudents }} </td>
            </ng-container>
            <ng-container matColumnDef="buses">
                <th mat-header-cell *matHeaderCellDef> {{ 'bus_allocation.buses' | translate }} </th>
                <td mat-cell *matCellDef="let alloc"> {{ formatBuses(alloc.buses) }} </td>
            </ng-container>
            <ng-container matColumnDef="allocationDate">
                <th mat-header-cell *matHeaderCellDef> {{ 'bus_allocation.allocationDate' | translate }} </th>
                <td mat-cell *matCellDef="let alloc"> {{ alloc.allocationDate | date:'medium' }} </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>
</body>